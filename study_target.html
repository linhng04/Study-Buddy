<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mục Tiêu Học Tập</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
        }
        .header {
            background-color: #4CAF50;
            color: white;
            text-align: center;
            padding: 20px;
        }
        .info-box {
            background-color: white;
            margin: 20px;
            padding: 15px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .info-box h3 {
            margin-top: 0;
        }
        .grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            table-layout: fixed; /* Cố định kích thước cột */
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        th {
            background-color: #4CAF50;
            color: white;
        }
        /* Đặt chiều rộng cho từng cột */
        th:nth-child(1), td:nth-child(1) { width: 20%; } /* Tên Môn */
        th:nth-child(2), td:nth-child(2) { width: 10%; } /* Số Tín */
        th:nth-child(3), td:nth-child(3) { width: 10%; } /* Chuyên Cần */
        th:nth-child(4), td:nth-child(4) { width: 10%; } /* Thi Giữa Kỳ */
        th:nth-child(5), td:nth-child(5) { width: 10%; } /* Thi Cuối Kỳ */
        th:nth-child(6), td:nth-child(6) { width: 15%; } /* Tỉ Lệ Tính Điểm */
        th:nth-child(7), td:nth-child(7) { width: 10%; } /* Trung Bình Môn (Hệ 10) */
        th:nth-child(8), td:nth-child(8) { width: 10%; } /* Trung Bình Môn (Hệ 4) */
        th:nth-child(9), td:nth-child(9) { width: 5%; }  /* Điểm Chữ */

        @media (max-width: 600px) {
            .grid {
                grid-template-columns: 1fr; /* Chuyển sang 1 cột trên màn hình nhỏ */
            }
            table {
                font-size: 12px; /* Giảm kích thước chữ cho màn hình nhỏ */
            }
        }
    </style>
</head>
<body>

    <div class="header">
        <h1>Mục Tiêu Học Tập</h1>
    </div>

    <div class="info-box" style="max-width: 400px; margin: 20px auto; text-align: center;">
        <h3>Mục Tiêu</h3>
        <p>Tổng tín chỉ đã đăng ký: <input type="number" id="totalCredits" placeholder="Tổng tín"></p>
        <p>Số tín chỉ cần đạt điểm A: <input type="number" id="creditsNeededA" placeholder="Điểm A"></p>
        <p>Số tín chỉ cần đạt điểm B: <input type="number" id="creditsNeededB" placeholder="Điểm B"></p>
    </div>

    <div class="grid">
        <div class="info-box">
            <h3>Học cải thiện môn D</h3>
            <p>Dự kiến cải thiện: <input type="text" id="improvementD" placeholder="Dự kiến cải thiện"></p>
            <p>Kết quả dự kiến cải thiện: <input type="number" id="resultD" placeholder="Kết quả cải thiện"></p>
        </div>
        <div class="info-box">
            <h3>Học lại môn F</h3>
            <p>Dự kiến học lại môn F: <input type="text" id="repeatF" placeholder="Học lại môn F"></p>
            <p>Kết quả học lại dự kiến: <input type="number" id="resultF" placeholder="Kết quả học lại"></p>
        </div>
        <div class="info-box">
            <h3>Dự kiến cải thiện</h3>
            <p>Dự kiến cải thiện: <input type="text" id="futureImprovement" placeholder="Dự kiến cải thiện"></p>
            <p>Kết quả cải thiện: <input type="number" id="futureResult" placeholder="Kết quả cải thiện"></p>
        </div>
    </div>

    <div class="info-box">
        <h3>Bảng kết quả dự kiến của kỳ học</h3>
        <table>
            <thead>
                <tr>
                    <th>Tên Môn</th>
                    <th>Số Tín</th>
                    <th>Chuyên Cần</th>
                    <th>Thi Giữa Kỳ</th>
                    <th>Thi Cuối Kỳ</th>
                    <th>Tỉ Lệ Tính Điểm</th>
                    <th>Trung Bình Môn (Hệ 10)</th>
                    <th>Trung Bình Môn (Hệ 4)</th>
                    <th>Điểm Chữ</th>
                </tr>
            </thead>
            <tbody id="subjectTable">
                <tr>
                    <td><input type="text" class="subject-name" placeholder="Tên môn"></td>
                    <td><input type="number" class="credits" placeholder="Số tín" onchange="calculateGrade(this)"></td>
                    <td><input type="number" class="attendance" placeholder="Chuyên cần" onchange="calculateGrade(this)"></td>
                    <td><input type="number" class="midterm" placeholder="Thi giữa kỳ" onchange="calculateGrade(this)"></td>
                    <td><input type="number" class="final" placeholder="Thi cuối kỳ" onchange="calculateGrade(this)"></td>
                    <td><input type="text" class="weight" placeholder="Tỉ lệ (vd: 30%: 20%: 50%)" onchange="calculateGrade(this)"></td>
                    <td class="avg-10"></td>
                    <td class="avg-4"></td>
                    <td class="grade"></td>
                </tr>
            </tbody>
        </table>
        <button onclick="addSubject()">Thêm môn</button>
        <h3>Kết quả trung bình tất cả</h3>
        <p id="overallAvg10">Trung Bình Tất Cả (Hệ 10): <strong>0</strong></p>
        <p id="overallAvg4">Trung Bình Tất Cả (Hệ 4): <strong>0</strong></p>
    </div>

    <script>
        function calculateGrade(element) {
            const row = element.closest('tr');
            const attendance = parseFloat(row.querySelector('.attendance').value) || 0;
            const midterm = parseFloat(row.querySelector('.midterm').value) || 0;
            const final = parseFloat(row.querySelector('.final').value) || 0;
            const credits = parseFloat(row.querySelector('.credits').value) || 0;

            // Lấy tỷ lệ từ ô input
            const weightInput = row.querySelector('.weight').value;
            const weights = weightInput.split(':').map(w => parseFloat(w.trim()) / 100); // Chia tỷ lệ cho 100

            // Tính điểm trung bình hệ 10
            const average10 = (attendance * (weights[0] || 0) + midterm * (weights[1] || 0) + final * (weights[2] || 0)).toFixed(2);
            row.querySelector('.avg-10').textContent = average10;

            // Tính toán điểm trung bình hệ 4
            const average4 = (average10 / 10 * 4).toFixed(2);
            row.querySelector('.avg-4').textContent = average4;

            // Tính điểm chữ
            let grade;
    if (average10 >= 9 && average10 <= 10) grade = 'A+';
    else if (average10 >= 8.5 && average10 < 9) grade = 'A';
    else if (average10 >= 8 && average10 < 8.5) grade = 'B+';
    else if (average10 >= 7 && average10 < 8) grade = 'B';
    else if (average10 >= 6.5 && average10 < 7) grade = 'C+';
    else if (average10 >= 5.5 && average10 < 6.5) grade = 'C';
    else if (average10 >= 5 && average10 < 5.5) grade = 'D+';
    else if (average10 >= 4 && average10 < 5) grade = 'D';
    else grade = 'F';
    row.querySelector('.grade').textContent = grade;

            calculateOverallAverage();
        }

        function addSubject() {
            const newRow = document.createElement('tr');
            newRow.innerHTML = `
                <td><input type="text" class="subject-name" placeholder="Tên môn"></td>
                <td><input type="number" class="credits" placeholder="Số tín" onchange="calculateGrade(this)"></td>
                <td><input type="number" class="attendance" placeholder="Chuyên cần" onchange="calculateGrade(this)"></td>
                <td><input type="number" class="midterm" placeholder="Thi giữa kỳ" onchange="calculateGrade(this)"></td>
                <td><input type="number" class="final" placeholder="Thi cuối kỳ" onchange="calculateGrade(this)"></td>
                <td><input type="text" class="weight" placeholder="Tỉ lệ (vd: 30%: 20%: 50%)" onchange="calculateGrade(this)"></td>
                <td class="avg-10"></td>
                <td class="avg-4"></td>
                <td class="grade"></td>
            `;
            document.getElementById('subjectTable').appendChild(newRow);
        }

        function calculateOverallAverage() {
            const rows = document.querySelectorAll('#subjectTable tr');
            let totalCredits = 0;
            let totalWeightedScore10 = 0;
            let totalWeightedScore4 = 0;

            rows.forEach(row => {
                const credits = parseFloat(row.querySelector('.credits').value) || 0;
                const avg10 = parseFloat(row.querySelector('.avg-10').textContent) || 0;
                const avg4 = parseFloat(row.querySelector('.avg-4').textContent) || 0;

                totalCredits += credits;
                totalWeightedScore10 += avg10 * credits;
                totalWeightedScore4 += avg4 * credits;
            });

            const overallAvg10 = (totalWeightedScore10 / totalCredits).toFixed(2) || 0;
            const overallAvg4 = (totalWeightedScore4 / totalCredits).toFixed(2) || 0;

            document.getElementById('overallAvg10').innerHTML = `Trung Bình Tất Cả (Hệ 10): <strong>${overallAvg10}</strong>`;
            document.getElementById('overallAvg4').innerHTML = `Trung Bình Tất Cả (Hệ 4): <strong>${overallAvg4}</strong>`;
        }
    </script>

</body>
</html>